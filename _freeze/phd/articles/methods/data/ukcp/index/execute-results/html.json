{
  "hash": "9058c9e6042719ad3af1280d5dac9d83",
  "result": {
    "markdown": "---\ntitle: \"UKCP Data\"\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(bggjphd)\nlibrary(tidyverse)\nlibrary(GGally)\nlibrary(cowplot)\nlibrary(glue)\ntheme_set(theme_bggj())\n```\n:::\n\n\n# Summary\n\nThe data used in this research are downloaded from the CEDA Archive:\n\n* [UKCP Local Projections on a 5km grid over the UK for 1980-2080](https://data.ceda.ac.uk/badc/ukcp18/data/land-cpm/uk/5km)\n\nThe raw data contain climate projections for the UK on a 5km grid from 1980 to 2080 for a high emissions scenario, *RCP8.5*, and contain hourly precipitation rates of $43.920$ squares on a $180 \\times 244$ grid. The projections are calculated for $1980 - 2000$, $2020 - 2040$, and $2060 - 2080$, thus giving $60 \\times 365 \\times 24 \\times 180 \\times 244 \\approx 2.3 \\cdot 10^{10}$ data points. \n\nThe raw data were processed by calculating the yearly maximum over the hourly precipitation rates for each station, thus reducing the number of data points to $60 \\times 180 \\times 244 \\approx 2.6 \\cdot 10^6$.\n\n# Summary statistics\n\n## Maximum precipitation\n\n\n::: {.cell}\n\n```{.r .cell-code}\np <- full_data |> \n  ggplot(aes(max_precip, y = after_stat(density))) +\n  geom_histogram(bins = 100) +\n  scale_x_continuous(\n    limits = c(0, NA),\n    expand = expansion()\n  ) +\n  scale_y_continuous(\n    expand = expansion()\n  ) +\n  labs(\n    x = NULL,\n    y = NULL,\n    title = \"Distribution of station-wise maximum precipitation over the period\"\n  )\n\nggsave(\n  plot = p,\n  filename = \"Figures/figure1.png\",\n  width = 8, height = 0.621 * 8, scale = 1.3\n)\n```\n:::\n\n\n![](Figures/figure1.png)\n\n\n::: {.cell}\n\n```{.r .cell-code}\np <- full_data |> \n  ggplot(aes(proj_x, proj_y, fill = max_precip)) +\n  geom_raster(\n    interpolate = TRUE\n  ) +\n  scale_x_continuous(\n    expand = expansion(),\n    breaks = c(range(full_data$proj_x), pretty(full_data$proj_x))\n  ) +\n  scale_y_continuous(\n    expand = expansion(),\n    breaks = c(range(full_data$proj_y), pretty(full_data$proj_y))\n  ) +\n  scale_fill_viridis_c() +\n  theme(\n    plot.margin = margin(t = 5, r = 25, b = 5, l = 5)\n  ) +\n  labs(\n    x = \"X Projection\",\n    y = \"Y Projection\",\n    fill = \"Maximum Precipitation\",\n    title = \"Spatial distribution of maximum precipitation\"\n  )\n\nggsave(\n  plot = p,\n  filename = \"Figures/figure2.png\",\n  width = 8, height = 0.621 * 8, scale = 1.3\n)\n```\n:::\n\n\n![](Figures/figure2.png)\n\n## Minimum precipitation\n\n\n::: {.cell}\n\n```{.r .cell-code}\np <- full_data |> \n  ggplot(aes(min_precip, y = after_stat(density))) +\n  geom_histogram(bins = 100) +\n  scale_x_continuous(\n    limits = c(0, NA),\n    expand = expansion()\n  ) +\n  scale_y_continuous(\n    expand = expansion()\n  ) +\n  labs(\n    x = NULL,\n    y = NULL,\n    title = \"Distribution of station-wise minimum precipitation over the period\"\n  )\n\nggsave(\n  plot = p,\n  filename = \"Figures/figure3.png\",\n  width = 8, height = 0.621 * 8, scale = 1.3\n)\n```\n:::\n\n\n![](Figures/figure3.png)\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\np <- full_data |> \n  ggplot(aes(proj_x, proj_y, fill = min_precip)) +\n  geom_raster(\n    interpolate = TRUE\n  ) +\n  scale_x_continuous(\n    expand = expansion(),\n    breaks = c(range(full_data$proj_x), pretty(full_data$proj_x))\n  ) +\n  scale_y_continuous(\n    expand = expansion(),\n    breaks = c(range(full_data$proj_y), pretty(full_data$proj_y))\n  ) +\n  scale_fill_viridis_c() +\n  theme(\n    # legend.position = \"top\",\n    plot.margin = margin(t = 5, r = 25, b = 5, l = 5)\n  ) +\n  labs(\n    x = \"X Projection\",\n    y = \"Y Projection\",\n    fill = \"Minimum Precipitation\",\n    title = \"Spatial distribution of minimum precipitation\"\n  )\nggsave(\n  plot = p,\n  filename = \"Figures/figure4.png\",\n  width = 8, height = 0.621 * 8, scale = 1.3\n)\n```\n:::\n\n\n![](Figures/figure4.png)\n\n\n# Example data\n\n\n::: {.cell .column-page layout-align=\"center\" fig.asp='0.8'}\n\n```{.r .cell-code}\nn_station <- 5\nprecip |> \n  filter(station <= n_station) |> \n  mutate(\n    period = case_when(\n      year <= 2000 ~ \"1980 - 2000\",\n      year <= 2040 ~ \"2020 - 2040\",\n      year <= 2080 ~ \"2060 - 2080\",\n    ),\n    station = glue(\"Station {station}\")\n  ) |> \n  ggplot(aes(year, precip)) +\n  geom_point(aes(group = station)) +\n  geom_segment(aes(yend = 0, xend = year)) +\n  geom_hline(yintercept = 0) +\n  scale_x_continuous(\n    breaks = c(\n      1981, \n      seq(1985, 2080, by = 5)\n    )\n  ) +\n  scale_y_continuous(\n    limits = c(0, 80),\n    expand = expansion()\n  ) +\n  facet_grid(rows = vars(station), cols = vars(period), scales = \"free_x\") +\n  theme(\n    panel.spacing = unit(0.03, \"npc\")\n  ) +\n  labs(\n    x = NULL,\n    y = NULL,\n    title = glue(\"Maximum hourly precipitation for {n_station} stations\"),\n    subtitle = \"Shown for each of the three modelled periods\"\n  )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-1.png){fig-align='center' width=100%}\n:::\n:::",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}